2023-04-09 21:43:23,793 - INFO - Config:
2023-04-09 21:43:23,793 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/eICU/LoS/LSTM",
    "batch_size": 512,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "bidirectional": false,
    "channelwise": false,
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "LSTM",
    "hidden_size": 128,
    "intermediate_reporting": false,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00129,
    "loss": "msle",
    "lstm_dropout_rate": 0.2,
    "main_dropout_rate": 0.45,
    "mode": "train",
    "model_type": "tpc",
    "n_epochs": 8,
    "n_layers": 2,
    "name": "LSTM",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "percentage_data": 100.0,
    "save_results_csv": false,
    "seed": 2831703268,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS"
}
2023-04-09 21:43:26,410 - INFO - Experiment set up.
2023-04-09 21:43:28,721 - INFO - BaseLSTM(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (lstm_dropout): Dropout(p=0.2, inplace=False)
  (main_dropout): Dropout(p=0.45, inplace=False)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (empty_module): EmptyModule()
  (lstm): LSTM(176, 128, num_layers=2, dropout=0.2)
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_los): Linear(in_features=257, out_features=17, bias=True)
  (point_mort): Linear(in_features=257, out_features=17, bias=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
)
2023-04-09 22:01:19,125 - INFO - Custom bins confusion matrix:
2023-04-09 22:01:19,126 - INFO - [[1108444  729911  142606   54627   26567   14700    8804    5461    9838
     2045]
 [ 483156  478088  132599   60116   32125   18713   11272    7078   12842
     2462]
 [ 226884  294495  103708   52940   29893   17868   10954    6995   13590
     2666]
 [ 118539  189757   80058   44020   26011   15777    9929    6489   12842
     2608]
 [  69680  127916   62001   35810   21606   13513    8733    5874   11691
     2452]
 [  43823   91272   48428   29368   18191   11570    7705    5104   10339
     2255]
 [  28746   67291   39243   24602   15413   10027    6528    4386    9088
     2116]
 [  19218   51052   31649   20849   13116    8443    5707    3852    8007
     1848]
 [  48652  148809  103622   69920   46908   31030   20979   14291   30320
     7295]
 [  22558   81516   66370   48836   33927   23305   16269   11569   25622
     6856]]
2023-04-09 22:01:23,921 - INFO - Epoch: 0 | Train Loss: 113.1170
2023-04-09 22:04:56,400 - INFO - Custom bins confusion matrix:
2023-04-09 22:04:56,401 - INFO - [[180602 217476  31511  11559   5324   2299    861    235     75      0]
 [ 64432 134786  33635  17154   8195   3532   1200    229     79      0]
 [ 26735  76575  27128  16494   9014   3802   1279    294     71      0]
 [ 13093  45019  20399  14752   8226   3654   1245    289    110      0]
 [  6957  28162  15273  12357   7655   3439   1181    401    117      0]
 [  4313  19237  11905  10075   6572   3364   1135    412    135      0]
 [  2921  12615   9406   8350   5657   2890   1088    384    149      0]
 [  1883   9455   7214   6828   5189   2628    929    317    182      0]
 [  3581  25468  24432  25480  17884   8456   3725   1819    351      0]
 [  1600  13549  15198  16403  12297   7088   3530   1552    471      0]]
2023-04-09 22:04:57,881 - INFO - Epoch: 0 | Validation Loss: 101.1362
2023-04-09 22:22:41,210 - INFO - Custom bins confusion matrix:
2023-04-09 22:22:41,211 - INFO - [[1088283  773842  131889   49860   24223   13066    7499    4648    8183
     1510]
 [ 430283  516115  140561   65252   34516   19026   11297    7027   12303
     2071]
 [ 188422  309257  113275   59650   33802   19663   11792    7636   13971
     2525]
 [  92725  192646   87360   50451   29763   18186   11342    7164   13788
     2605]
 [  51270  126551   66526   40919   25501   16017   10336    6783   12832
     2541]
 [  31546   86066   52238   33818   21477   13714    9002    5924   11811
     2459]
 [  19964   61466   41501   28150   18410   12099    7806    5281   10498
     2265]
 [  12574   45061   33085   23457   15733   10374    6884    4794    9704
     2075]
 [  28650  125012  105979   79548   55162   37868   25800   17725   37281
     8801]
 [  11688   61983   63559   53642   39929   28689   20529   14665   33092
     9052]]
2023-04-09 22:22:46,022 - INFO - Epoch: 1 | Train Loss: 102.1965
2023-04-09 22:26:18,504 - INFO - Custom bins confusion matrix:
2023-04-09 22:26:18,505 - INFO - [[205629 193519  29545  11770   5582   2515    924    345    113      0]
 [ 73325 124945  32662  17905   8961   3760   1302    266    116      0]
 [ 30553  71248  26265  17178  10122   4256   1240    428    102      0]
 [ 15196  41665  19314  15287   9518   4014   1167    503    123      0]
 [  8128  25656  14905  12496   8676   3831   1194    470    186      0]
 [  4869  17695  11330  10500   7274   3520   1273    501    186      0]
 [  3298  11475   8962   8586   6109   3037   1340    458    195      0]
 [  2109   8525   6783   7077   5599   2805   1179    321    227      0]
 [  4514  22894  21649  25628  20529   9426   4337   1533    686      0]
 [  2122  12084  13134  16716  13653   7434   4359   1621    565      0]]
2023-04-09 22:26:20,559 - INFO - Epoch: 1 | Validation Loss: 96.8672
2023-04-09 22:44:04,991 - INFO - Custom bins confusion matrix:
2023-04-09 22:44:04,992 - INFO - [[1030708  833186  132063   49511   23802   12617    7379    4436    7825
     1476]
 [ 387199  551845  146381   67529   34574   19043   11359    6833   11721
     1967]
 [ 164707  323489  118112   62669   34720   20344   12270    7644   13722
     2316]
 [  78808  198241   90919   52816   31290   18744   11746    7246   13705
     2515]
 [  42975  126776   69352   43386   27026   16843   10458    6788   13087
     2585]
 [  25887   84995   53335   35715   23331   14482    9481    6239   12156
     2434]
 [  16069   59737   42421   29946   19604   12722    8223    5580   10911
     2227]
 [   9997   42767   33706   24800   16897   11308    7251    4942    9953
     2120]
 [  22145  116341  105514   83660   58961   39989   27557   18864   39420
     9375]
 [   8837   54373   61775   54887   41840   30234   21694   15726   36882
    10580]]
2023-04-09 22:44:09,861 - INFO - Epoch: 2 | Train Loss: 98.2452
2023-04-09 22:47:41,667 - INFO - Custom bins confusion matrix:
2023-04-09 22:47:41,667 - INFO - [[195045 203074  30206  11488   5633   2635   1170    471    220      0]
 [ 65739 130606  33368  17967   9213   4102   1471    519    257      0]
 [ 26676  73293  26790  17240  10096   4851   1572    525    349      0]
 [ 13160  42499  19522  14936   9695   4609   1307    678    381      0]
 [  6911  25939  14924  12443   8624   4249   1394    593    465      0]
 [  4069  18001  11173  10236   7216   3916   1446    645    446      0]
 [  2661  11684   8788   8365   6116   3272   1577    595    402      0]
 [  1792   8542   6826   6618   5601   3004   1340    530    372      0]
 [  3713  22537  20999  23834  20610  10849   5095   2159   1400      0]
 [  1861  11597  12553  15675  12914   8663   4511   2658   1256      0]]
2023-04-09 22:47:43,197 - INFO - Epoch: 2 | Validation Loss: 95.1904
2023-04-09 23:05:27,009 - INFO - Custom bins confusion matrix:
2023-04-09 23:05:27,009 - INFO - [[1031292  834096  131837   49329   23285   12610    7112    4328    7689
     1425]
 [ 376855  557856  149940   68317   35079   19438   11145    6760   11223
     1838]
 [ 157120  324030  121585   65174   35913   20434   12220    7619   13592
     2306]
 [  74275  195836   93918   55316   32428   19132   11703    7451   13578
     2393]
 [  39930  124715   71019   45345   27752   17037   10881    6989   13102
     2506]
 [  24003   82586   54381   37135   23726   15317    9827    6521   12183
     2376]
 [  14393   57478   43349   30923   20643   13066    8397    5616   11215
     2360]
 [   8874   40586   34092   25790   17638   11465    7611    5137   10276
     2272]
 [  19345  108152  105647   86138   61901   42038   28380   19569   41220
     9436]
 [   7642   48071   59552   55422   43555   32082   23503   16706   38686
    11609]]
2023-04-09 23:05:31,823 - INFO - Epoch: 3 | Train Loss: 95.7710
2023-04-09 23:09:03,633 - INFO - Custom bins confusion matrix:
2023-04-09 23:09:03,634 - INFO - [[211797 180929  34382  12377   5691   2673   1234    516    343      0]
 [ 72369 118320  37051  19028   9493   4442   1570    688    281      0]
 [ 29773  66288  28794  18047  10438   5150   1901    622    379      0]
 [ 14657  38490  20448  15400   9897   5048   1680    747    420      0]
 [  7981  23133  15407  12767   8818   4460   1773    730    473      0]
 [  4578  16263  11588  10171   7306   4228   1761    753    500      0]
 [  3090  10384   8814   8450   6220   3634   1579    811    478      0]
 [  2081   7456   6921   6849   5303   3366   1457    746    446      0]
 [  4343  19815  20695  23621  20514  11835   6114   2511   1748      0]
 [  2136  10281  12379  15083  13352   8567   4826   3264   1800      0]]
2023-04-09 23:09:05,691 - INFO - Epoch: 3 | Validation Loss: 93.7191
2023-04-09 23:26:49,746 - INFO - Custom bins confusion matrix:
2023-04-09 23:26:49,746 - INFO - [[1043860  821411  132725   49957   23403   12125    6979    4115    7055
     1373]
 [ 375300  554199  153961   70262   35257   19364   10899    6483   10970
     1756]
 [ 154451  320098  125973   66900   36768   20760   12311    7525   13037
     2170]
 [  72165  191910   96890   57095   32926   19849   11887    7275   13607
     2426]
 [  38406  120500   73346   46946   28486   17534   11238    7003   13212
     2605]
 [  22393   79783   55764   38502   24890   15606    9855    6432   12320
     2510]
 [  13605   54605   43925   32205   21320   13468    8852    5713   11289
     2458]
 [   8213   38297   34649   26650   17928   11996    7838    5148   10717
     2305]
 [  17788   98325  105864   88036   63622   44316   29515   20643   43266
    10451]
 [   6656   41887   57434   55289   44485   33094   24213   17535   42805
    13430]]
2023-04-09 23:26:54,630 - INFO - Epoch: 4 | Train Loss: 93.5052
2023-04-09 23:30:28,931 - INFO - Custom bins confusion matrix:
2023-04-09 23:30:28,931 - INFO - [[212644 177015  37096  12433   5910   2729   1200    549    366      0]
 [ 72365 115946  39011  18731  10154   4276   1786    659    314      0]
 [ 29511  64731  29912  17882  11017   5200   2158    537    444      0]
 [ 14546  37419  21387  15174  10038   5117   1829    771    506      0]
 [  7896  22634  15869  12301   9176   4507   1862    785    512      0]
 [  4571  15760  11967   9808   7568   4291   1910    743    530      0]
 [  3119  10008   9105   8256   6200   3721   1747    772    532      0]
 [  2084   7267   7025   6614   5482   3330   1585    780    458      0]
 [  4213  19464  21361  22749  19667  12845   6245   2828   1824      0]
 [  2163   9894  12545  14748  12875   9245   5061   3171   1986      0]]
2023-04-09 23:30:29,031 - INFO - Epoch: 4 | Validation Loss: 93.3457
2023-04-09 23:48:14,423 - INFO - Custom bins confusion matrix:
2023-04-09 23:48:14,424 - INFO - [[1054147  812657  133732   49150   22880   11731    6678    3951    6844
     1233]
 [ 375258  552969  155853   71068   35186   18875   10633    6293   10626
     1690]
 [ 152574  317827  129164   67823   37103   20697   12165    7609   12824
     2207]
 [  70243  189522   99142   58316   33652   19851   11869    7391   13553
     2491]
 [  36989  117919   74652   48266   29384   17769   11255    6998   13382
     2662]
 [  21465   76954   56805   39813   25166   15831    9942    6723   12670
     2686]
 [  13021   51751   44632   33041   21715   14041    8765    5969   11789
     2716]
 [   7593   35932   34837   27436   18770   12317    8062    5388   10894
     2512]
 [  16349   91068  104910   89292   65225   45070   30814   21322   46152
    11624]
 [   5930   36851   55471   54922   44936   33983   24996   18446   45907
    15386]]
2023-04-09 23:48:19,289 - INFO - Epoch: 5 | Train Loss: 91.5784
2023-04-09 23:51:51,152 - INFO - Custom bins confusion matrix:
2023-04-09 23:51:51,152 - INFO - [[211160 172042  41366  13779   6110   2958   1435    638    454      0]
 [ 71657 111548  41443  20244  10338   4667   2022    821    502      0]
 [ 29188  61454  31768  18673  11208   5228   2506    801    566      0]
 [ 14648  35206  22149  15733   9987   5404   2058    907    695      0]
 [  7924  21175  16074  13085   8899   4590   2127    947    721      0]
 [  4605  14626  12074  10240   7426   4358   2281    837    701      0]
 [  3133   9286   9147   8354   6322   3591   2019    912    696      0]
 [  2121   6716   7131   6688   5257   3454   1823    780    655      0]
 [  4452  17985  21450  22594  18640  13010   7324   3311   2430      0]
 [  2304   9374  12231  14480  12565   8860   5681   3165   3028      0]]
2023-04-09 23:51:52,635 - INFO - Epoch: 5 | Validation Loss: 93.4471
2023-04-10 00:09:35,498 - INFO - Custom bins confusion matrix:
2023-04-10 00:09:35,499 - INFO - [[1063576  806845  132352   48379   22360   11478    6309    3812    6630
     1262]
 [ 377373  550343  157156   71082   35222   18633   10491    6162   10273
     1716]
 [ 151972  316112  131152   68777   37013   20646   11951    7258   12731
     2381]
 [  69284  187430  100394   59064   33844   20107   11982    7538   13801
     2586]
 [  35862  115839   76148   48550   29654   18083   11485    7250   13563
     2842]
 [  20610   74747   57796   40269   25730   16049   10284    6668   13096
     2806]
 [  12241   50135   45259   33337   22280   14107    9264    5989   12198
     2630]
 [   7313   34084   34960   27854   19098   12554    8410    5528   11217
     2723]
 [  15281   84964  103826   90170   66378   46087   31598   22008   48463
    13051]
 [   5437   33936   52786   54193   44786   34570   25734   19202   49011
    17173]]
2023-04-10 00:09:40,304 - INFO - Epoch: 6 | Train Loss: 90.0510
2023-04-10 00:13:12,560 - INFO - Custom bins confusion matrix:
2023-04-10 00:13:12,561 - INFO - [[200516 175417  44585  15786   7094   3374   1705    776    680      9]
 [ 65963 110997  44184  21688  10971   5468   2302    891    773      5]
 [ 26747  59923  32730  19602  12043   5789   2741    959    858      0]
 [ 13446  34026  22222  16078  10825   5635   2591   1026    938      0]
 [  7222  20192  16115  12984   9369   5045   2545   1121    949      0]
 [  4279  13472  12370  10125   7647   4734   2428   1199    894      0]
 [  2902   8627   9065   8198   6505   3985   2059   1174    945      0]
 [  1953   6321   6740   6787   5364   3505   1974   1110    871      0]
 [  4216  16482  20306  22337  18788  13343   8066   4257   3401      0]
 [  2256   8607  11620  14002  12074   9430   5968   3293   4403     35]]
2023-04-10 00:13:14,124 - INFO - Epoch: 6 | Validation Loss: 93.9041
2023-04-10 00:30:58,577 - INFO - Custom bins confusion matrix:
2023-04-10 00:30:58,577 - INFO - [[1075906  798665  129906   47934   22112   11140    6251    3665    6259
     1165]
 [ 381308  546817  158118   71284   34674   18311   10243    6060    9925
     1711]
 [ 152766  312835  131579   70102   37425   20799   12033    7436   12717
     2301]
 [  68722  184900  100496   60529   34932   20230   12100    7564   13938
     2619]
 [  35016  113744   76246   49874   30272   18385   11318    7413   14108
     2900]
 [  20011   72819   57428   41523   25999   16453   10511    6746   13548
     3017]
 [  11716   48728   44602   34129   22663   14423    9393    6177   12489
     3120]
 [   6858   32697   34384   28299   19437   12962    8597    5714   11803
     2990]
 [  14676   79427  100629   91367   67764   47319   32943   22507   50730
    14464]
 [   4903   29421   48992   52847   45143   35196   26513   20066   52702
    21045]]
2023-04-10 00:31:03,392 - INFO - Epoch: 7 | Train Loss: 88.3668
2023-04-10 00:34:35,940 - INFO - Custom bins confusion matrix:
2023-04-10 00:34:35,941 - INFO - [[205239 173082  42735  15204   6615   3358   1900    915    872     22]
 [ 68369 110619  42918  20689  10767   5326   2319   1195   1038      2]
 [ 27917  60249  31693  18865  11461   6043   2787   1286   1087      4]
 [ 14225  34007  22023  15460   9824   5953   2839   1207   1243      6]
 [  7549  20581  15831  12221   8707   5275   2757   1342   1279      0]
 [  4527  13639  12403   9498   7288   4608   2610   1380   1177     18]
 [  3039   8715   9022   7873   6256   3835   2251   1286   1164     19]
 [  1951   6585   6892   6202   5253   3434   2014   1159   1132      3]
 [  4489  16666  20761  21235  18469  12606   7864   4687   4419      0]
 [  2653   8848  11539  13866  10844   8801   5633   4067   5345     92]]
2023-04-10 00:34:37,746 - INFO - Epoch: 7 | Validation Loss: 93.9598
2023-04-10 00:34:37,758 - INFO - Experiment ended. Checkpoints stored =)
